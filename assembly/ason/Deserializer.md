# Rules

- DigestedBuffer -> (Null | Array | Object | Value) End
  - Assert: Offset is 0
  - Match Array | Object -> Assert: classId matches `idof<T>()`
- Null -> NullSegment
- Array -> ArraySegment (DataSegment | Object:* | Array:*) Pop
- Object -> ObjectSegment (Null | Array | Object | Value):* Pop
- Value -> ValueSegment
- End -> EndSegment

# Loopless Shape Prediction

```ts
class A {
  a: B;
  b: f32;
  c: i64;

  // autogenerated by createPutFunction
  __asonPut(ser: Serializer, seen: Map<usize, u32>, props: StaticArray<u32> = []): void {
    if (!props.includes(hash("a"))) ser.put(this.a, offsetof<A>("a"), seen);
    if (!props.includes(hash("b"))) set.put(this.b, offsetof<A>("b"), seen);
    if (!props.includes(hash("c"))) set.put(this.c, offsetof<A>("b"), seen);
    if (isDefined(super.__asonPut)) super.__asonPut(ser, seen, props.concat([
      // auto generated to a `u32` number literal
      <u32>dbj2hash("a"),
      <u32>dbj2hash("b"),
      <u32>dbj2hash("c"),
    ]));
  }

  // autogenerated by createDigestFunction
  __asonDigest(de: Deserializer, seen: Map<usize, u32>, props: StaticArray<u32> = []): void {
    if (!props.includes(hash("a"))) de.digestReferenceProp(this, offsetof<A>("a"), seen);
    if (!props.includes(hash("b"))) de.digestReferenceProp(this, offsetof<A>("b"), seen);
    if (!props.includes(hash("c"))) de.digestReferenceProp(this, offsetof<A>("c"), seen);
    if (isDefined(super.__asonDigest)) super.__asonDigest(ser, seen, props.concat([
      // auto generated to a `u32` number literal
      <u32>dbj2hash("a"),
      <u32>dbj2hash("b"),
      <u32>dbj2hash("c"),
    ]));
  }
}

```